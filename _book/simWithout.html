<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 4 Simulation of a population and a sampling WITHOUT covariates | mashup: N-mixture models</title>
  <meta name="description" content="derived from the bookdown minimal example. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22.17 and GitBook 2.6.7" />

  <meta property="og:title" content=" 4 Simulation of a population and a sampling WITHOUT covariates | mashup: N-mixture models" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="derived from the bookdown minimal example. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 4 Simulation of a population and a sampling WITHOUT covariates | mashup: N-mixture models" />
  
  <meta name="twitter:description" content="derived from the bookdown minimal example. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Cord Phelps" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gen.html"/>
<link rel="next" href="unmarked.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">a label in _output.yml</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <span>https://stackoverflow.com/questions/51424537/whats-the-difference-between-bookdown-yml-output-yml-and-yaml-header-of</span></a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="gen.html"><a href="gen.html"><i class="fa fa-check"></i><b>3</b> N mixture models: In General</a></li>
<li class="chapter" data-level="4" data-path="simWithout.html"><a href="simWithout.html"><i class="fa fa-check"></i><b>4</b> Simulation of a population and a sampling WITHOUT covariates</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simWithout.html"><a href="simWithout.html#the-poisson-distribution"><i class="fa fa-check"></i><b>4.1</b> the Poisson distribution</a></li>
<li class="chapter" data-level="4.2" data-path="simWithout.html"><a href="simWithout.html#distribute-a-simulated-deer-population"><i class="fa fa-check"></i><b>4.2</b> distribute a simulated deer population</a></li>
<li class="chapter" data-level="4.3" data-path="simWithout.html"><a href="simWithout.html#sampling-simulation"><i class="fa fa-check"></i><b>4.3</b> Sampling Simulation</a></li>
<li class="chapter" data-level="4.4" data-path="simWithout.html"><a href="simWithout.html#sampled-cells"><i class="fa fa-check"></i><b>4.4</b> Sampled Cells</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="unmarked.html"><a href="unmarked.html"><i class="fa fa-check"></i><b>5</b> The simplest N-mixture model with unmarked</a></li>
<li class="chapter" data-level="6" data-path="simulation-of-the-study-area-and-sampling-with-covariates.html"><a href="simulation-of-the-study-area-and-sampling-with-covariates.html"><i class="fa fa-check"></i><b>6</b> Simulation of the study area and sampling WITH covariates</a></li>
<li class="chapter" data-level="7" data-path="ref.html"><a href="ref.html"><i class="fa fa-check"></i><b>7</b> references</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">mashup: N-mixture models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simWithout" class="section level1" number="4">
<h1><span class="header-section-number"> 4</span> Simulation of a population and a sampling WITHOUT covariates</h1>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>Con ayuda de R, vamos a simular una población de ciervos que se distribuye en un área de 100 km2 (100 cuadrados de 1 km de lado)</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>With the help of R, we are going to simulate a deer population that is distributed in an area of 100 km2 (100 squares of 1 km on each side)</p>
</div>
</div>
<p><br /></p>
<div id="the-poisson-distribution" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> the Poisson distribution</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="simWithout.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># ajustamos una &quot;semilla&quot;&quot; para controlar la repetibilidad </span></span>
<span id="cb1-2"><a href="simWithout.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Con el paquete &quot;raster&quot; creamos una cuadrícula de 10x10</span></span>
<span id="cb1-3"><a href="simWithout.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-4"><a href="simWithout.html#cb1-4" aria-hidden="true" tabindex="-1"></a>sarea <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">nrows =</span> <span class="dv">10</span>, <span class="at">ncols =</span> <span class="dv">10</span>, <span class="at">xmn =</span> <span class="dv">0</span>, <span class="at">xmx =</span> <span class="dv">10</span>, <span class="at">ymn =</span> <span class="dv">0</span>, <span class="at">ymx =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>Este área de momento está vacía, por lo que tendremos que “llenarla” de ciervos virtuales (proceso de abundancia, o state process). Podemos utilizar una distribución de Poisson para “esparcir” nuestros ciervos simulados en el área de estudio. Esta distrubución es una de las más comunmente utilizadas en el estudio de abundancias. La distribución de Poisson maneja la frecuencia con la que un evento ocurre en un intervalo específico. Consta de un único parámetro llamado lambda λ que determina el número de eventos que ocurren normalmente en ese intervalo.</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>This area is currently empty, so we will have to “fill” it with virtual deer (abundance process, or state process). We can use a Poisson distribution to “spread” our simulated deer in the study area. This distribution is one of the most commonly used in the study of abundances. The Poisson distribution handles the frequency with which an event occurs in a specific interval. It consists of a single parameter called lambda λ that determines the number of events that normally occur in that interval.</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="simWithout.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a random poisson distribution, 10000 values</span></span>
<span id="cb2-2"><a href="simWithout.html#cb2-2" aria-hidden="true" tabindex="-1"></a>poissonVector <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">lambda =</span> <span class="dv">4</span>)</span>
<span id="cb2-3"><a href="simWithout.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert the vector into a df</span></span>
<span id="cb2-4"><a href="simWithout.html#cb2-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">poissonCount =</span> poissonVector)</span>
<span id="cb2-5"><a href="simWithout.html#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="simWithout.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> poissonCount)) <span class="sc">+</span></span>
<span id="cb2-7"><a href="simWithout.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="simWithout.html#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="simWithout.html#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">&quot;poisson value (count)&quot;</span>, </span>
<span id="cb2-10"><a href="simWithout.html#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;occurrences (frequency)&quot;</span>, </span>
<span id="cb2-11"><a href="simWithout.html#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;poisson distribution</span><span class="sc">\n</span><span class="st">lambda = 4&quot;</span>)</span></code></pre></div>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="width:45%">
<p><img src="bookdown-demo_files/figure-html/gg1-1.png" width="672" /></p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p><img src="bookdown-demo_files/figure-html/gg2-1.png" width="672" /></p>
</div>
</div>
<p><br /></p>
</div>
<div id="distribute-a-simulated-deer-population" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> distribute a simulated deer population</h2>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>En nuestro caso, el intervalo una unidad espacial, una cuadrícula, mientras que el evento será la presencia de un ciervo. El parámetro λ será la “abundancia esperada,” esto es, la abundancia media por cuadrícula. El número y la distribución de los ciervos virtuales que colocaremos en nuestro área de estudio vendrá determinado por una distribución de Poisson con λ=4:</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>In our case, the interval will be a spatial unit, a grid, while the event will be the presence of a deer. The parameter λ will be the “expected abundance,” that is, the mean abundance per grid. The number and distribution of virtual deer that we will place in our study area will be determined by a Poisson distribution with λ = 4:</p>
</div>
</div>
<p><br /></p>
<p><span class="math display">\[ N_{i} \sim Poisson(λ) \]</span>
<br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>siendo <span class="math inline">\(N_{i}\)</span> el número total de individuos en la celda i.</p>
<p>Como podemos ver en el histograma de la izquierda, los valores más probables serán 3 o 4 ciervos, aunque variarán entre cero y 14 aproximadamente (aunque este útimo valor será muy poco probable).</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>where <span class="math inline">\(N_{i}\)</span> is the total number of individuals in cell i.</p>
<p>As we can see in the histogram on the left, the most probable values will be 3 or 4 deer, although they will vary between zero and 14 approximately (although this last value will be very unlikely).</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="simWithout.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Javier&#39;s chart: below left</span></span>
<span id="cb3-2"><a href="simWithout.html#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="simWithout.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos el lambda deseado</span></span>
<span id="cb3-4"><a href="simWithout.html#cb3-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb3-5"><a href="simWithout.html#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="simWithout.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos 100 números aleatorios obtenidos de una distribucion</span></span>
<span id="cb3-7"><a href="simWithout.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># de Poisson con una lambda = 4</span></span>
<span id="cb3-8"><a href="simWithout.html#cb3-8" aria-hidden="true" tabindex="-1"></a>sarea[] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">100</span>, lambda)  </span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="simWithout.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Javier&#39;s chart: below left</span></span>
<span id="cb4-2"><a href="simWithout.html#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="simWithout.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sarea) </span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="simWithout.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() setup </span></span>
<span id="cb5-2"><a href="simWithout.html#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="simWithout.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract S4 data and build vector</span></span>
<span id="cb5-4"><a href="simWithout.html#cb5-4" aria-hidden="true" tabindex="-1"></a>area.vector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(sarea)</span>
<span id="cb5-5"><a href="simWithout.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to matrix</span></span>
<span id="cb5-6"><a href="simWithout.html#cb5-6" aria-hidden="true" tabindex="-1"></a>area.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(area.vector, <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">ncol=</span><span class="dv">10</span>)</span>
<span id="cb5-7"><a href="simWithout.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse the rows (so we can compare plots)</span></span>
<span id="cb5-8"><a href="simWithout.html#cb5-8" aria-hidden="true" tabindex="-1"></a>area.matrix <span class="ot">&lt;-</span> <span class="fu">apply</span>(area.matrix,<span class="dv">2</span>,rev)</span>
<span id="cb5-9"><a href="simWithout.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(area.matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)</span>
<span id="cb5-10"><a href="simWithout.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(area.matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)</span>
<span id="cb5-11"><a href="simWithout.html#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="simWithout.html#cb5-12" aria-hidden="true" tabindex="-1"></a>longData<span class="ot">&lt;-</span><span class="fu">melt</span>(area.matrix)</span>
<span id="cb5-13"><a href="simWithout.html#cb5-13" aria-hidden="true" tabindex="-1"></a>longData<span class="ot">&lt;-</span>longData[longData<span class="sc">$</span>value<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb5-14"><a href="simWithout.html#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="simWithout.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-16"><a href="simWithout.html#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># have ggplot() use the same colors as does plot()</span></span>
<span id="cb5-17"><a href="simWithout.html#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb5-18"><a href="simWithout.html#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># fine tuning</span></span>
<span id="cb5-19"><a href="simWithout.html#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the first element to shift the</span></span>
<span id="cb5-20"><a href="simWithout.html#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># yellow closer to the middle of the palette</span></span>
<span id="cb5-21"><a href="simWithout.html#cb5-21" aria-hidden="true" tabindex="-1"></a>color.vector <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">terrain.colors</span>(<span class="dv">12</span>))</span>
<span id="cb5-22"><a href="simWithout.html#cb5-22" aria-hidden="true" tabindex="-1"></a>color.vector <span class="ot">&lt;-</span> color.vector[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(color.vector)]</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="simWithout.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() below right</span></span>
<span id="cb6-2"><a href="simWithout.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="simWithout.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(longData, <span class="fu">aes</span>(<span class="at">x =</span> Var2, <span class="at">y =</span> Var1)) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="simWithout.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value)) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="simWithout.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span>color.vector) <span class="sc">+</span></span>
<span id="cb6-6"><a href="simWithout.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<div style="display: flex;">
<div class="col" style="border-style:solid; width:45%">
<p><img src="bookdown-demo_files/figure-html/area1-1.png" width="672" /></p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p><img src="bookdown-demo_files/figure-html/area2-1.png" width="672" /></p>
</div>
</div>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>Si hacemos la suma de todas las celdas de nuestro área de estudio, podremos saber el número total de individuos que hemos simulado (N):</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>If we do the sum of all the cells in our study area, we will be able to know the total number of individuals that we have simulated (N):</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="simWithout.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos el número total de ciervos virtuales creados (N)</span></span>
<span id="cb7-2"><a href="simWithout.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(sarea[])</span></code></pre></div>
<pre><code>## [1] 368</code></pre>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>Podemos también hacer la media de individuos en cada celda, que debería aproximarse a λ=4:</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>We can also take the average of individuals in each cell, which should approximate λ = 4:</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="simWithout.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sarea[])</span></code></pre></div>
<pre><code>## [1] 3.68</code></pre>
<p><br /></p>
</div>
<div id="sampling-simulation" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Sampling Simulation</h2>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>A continuación tenemos que simular nuestro muestreo (proceso de detectabilidad o observational process). Éste consistirá en 15 cuadrículas aleatorias de nuestro área de estudio a las cuales realizaremos 4 visitas (ocasiones). Durante los muestreos intentaremos detectar el máximo número posible de ciervos, pero desgraciadamente sabemos que tenemos una eficacia o probabilidad de detección del 40% para todo nuestro área de estudio. Esto significa que, en general, seremos capaces de detectar menos de la mitad de ciervos en cada muestreo. Para simular esta detectabilidad podemos utilizar una distribución binomial. La distribución binomial maneja la probabilidad de éxito para un número de sucesos con dos resultados posibles: éxito o fracaso (cara o cruz, par o impar, etc.). Pongamos que una celda tiene 10 ciervos. La detección de cada uno de esos 10 ciervos puede verse como 10 sucesos en los que puedo tener éxito (detecto al ciervo) o fracasar (el ciervo está, pero no lo detecto). De esta forma, tendríamos que</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>Next we have to simulate our sampling (detectability process or observational process). This will consist of 15 random grids from our study area to which we will make 4 visits (occasions). During the samplings we will try to detect the maximum possible number of deer, but unfortunately we know that we have an efficiency or probability of detection of 40% for our entire study area. This means that, in general, we will be able to detect less than half the deer in each sample. To simulate this detectability we can use a binomial distribution. The binomial distribution handles the probability of success for a number of events with two possible outcomes: success or failure (heads or tails, even or odd, etc.). Let’s say a cell has 10 deer. Detecting each of those 10 deer can be viewed as 10 events where I can either succeed (detect the deer) or fail (the deer is there, but I don’t detect it). In this way, we have</p>
</div>
</div>
<p><br /></p>
<p><span class="math display">\[ y_{i,k} \sim binomial(N_{i},p) \]</span>
<br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>dónde <span class="math inline">\(y_{i,k}\)</span> es el número de individuos detectados en la celda i en la visita/ocasión k, <span class="math inline">\(N_{i}\)</span> es el número de individuos en la celda i y p es la probabilidad de detectar cada ciervo, siendo en nuestro caso p=0.4. Recapitulando, muestrearemos 15 cuadrículas aleatorias durante 4 visitas diferentes. En cada visita tendremos una probabilidad del 40% de ver cada uno de los ciervos que se encuentren en la cuadrícula. El siguiente código simula este proceso:</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>where <span class="math inline">\(y_{i,k}\)</span> is the number of individuals detected in cell i on visit / occasion k, <span class="math inline">\(N_{i}\)</span> is the number of individuals in cell i and p is the probability of detecting each deer, in our case being p = 0.4. Recapping, we will sample 15 random grids during 4 different visits. In each visit we will have a 40% probability of seeing each of the deer that are in the grid. The following code simulates this process:</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="simWithout.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos 15 celdas aleatorias de nuestro area de estudio</span></span>
<span id="cb11-2"><a href="simWithout.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (We selected 15 random cells from our study area)</span></span>
<span id="cb11-3"><a href="simWithout.html#cb11-3" aria-hidden="true" tabindex="-1"></a>site_ID <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">15</span>)</span>
<span id="cb11-4"><a href="simWithout.html#cb11-4" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(site_ID)</span>
<span id="cb11-5"><a href="simWithout.html#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="simWithout.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vamos a almacenar en número real de individuos de cada celda para poder hacer </span></span>
<span id="cb11-7"><a href="simWithout.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># comparaciones posteriormente</span></span>
<span id="cb11-8"><a href="simWithout.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (We are going to store the real number of individuals in each cell to be able </span></span>
<span id="cb11-9"><a href="simWithout.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  to make comparisons later)</span></span>
<span id="cb11-10"><a href="simWithout.html#cb11-10" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>trueN <span class="ot">&lt;-</span> <span class="fu">extract</span>(sarea,site_ID)</span>
<span id="cb11-11"><a href="simWithout.html#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="simWithout.html#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Iniciamos nuestras 4 visitas</span></span>
<span id="cb11-13"><a href="simWithout.html#cb11-13" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>O1 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-14"><a href="simWithout.html#cb11-14" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>O2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-15"><a href="simWithout.html#cb11-15" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>O3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-16"><a href="simWithout.html#cb11-16" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>O4 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-17"><a href="simWithout.html#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="simWithout.html#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Con un doble bucle, visitarremos 4 veces cada uno de nuestras 15 cuadrículas</span></span>
<span id="cb11-19"><a href="simWithout.html#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># (With a double loop, we will visit each of our 15 grids 4 times)</span></span>
<span id="cb11-20"><a href="simWithout.html#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb11-21"><a href="simWithout.html#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(site_ID)){</span>
<span id="cb11-22"><a href="simWithout.html#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Nótese que los individuos detectados vienen determinados por una </span></span>
<span id="cb11-23"><a href="simWithout.html#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># binomial con probabilidad 0.4, véase help(rbinom)</span></span>
<span id="cb11-24"><a href="simWithout.html#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># (Note that the detected individuals are determined by a binomial </span></span>
<span id="cb11-25"><a href="simWithout.html#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  with probability 0.4, see help (rbinom))</span></span>
<span id="cb11-26"><a href="simWithout.html#cb11-26" aria-hidden="true" tabindex="-1"></a>    dataset[i,j<span class="sc">+</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="fu">extract</span>(sarea,site_ID[i]), <span class="fl">0.4</span>)</span>
<span id="cb11-27"><a href="simWithout.html#cb11-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-28"><a href="simWithout.html#cb11-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>(so the model is assuming that each cell has a static micro-population of deer, but the observer does not know that number. rbinom() gives us different counts for each cell for each of the four visits)
<br /></p>
</div>
<div id="sampled-cells" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Sampled Cells</h2>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>Una vez realizado el muestreo, veamos el resultado del mismo. Primero graficamos nuestro área de estudio con las celdas muestreadas:</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>Once the sampling is done, let’s see the result of it. First we graph our study area with the sampled cells:</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="simWithout.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Javier&#39;s chart: below left</span></span>
<span id="cb12-2"><a href="simWithout.html#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="simWithout.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sarea)</span>
<span id="cb12-4"><a href="simWithout.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(sarea,site_ID), <span class="at">pch =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="simWithout.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() rough equivalent: below right</span></span>
<span id="cb13-2"><a href="simWithout.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="simWithout.html#cb13-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">xyFromCell</span>(sarea,site_ID))</span>
<span id="cb13-4"><a href="simWithout.html#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="simWithout.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fine tuning the cell colors.....</span></span>
<span id="cb13-6"><a href="simWithout.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the first element to shift the</span></span>
<span id="cb13-7"><a href="simWithout.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># yellow closer to the middle of the palette</span></span>
<span id="cb13-8"><a href="simWithout.html#cb13-8" aria-hidden="true" tabindex="-1"></a>color.vector <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">terrain.colors</span>(<span class="dv">12</span>))</span>
<span id="cb13-9"><a href="simWithout.html#cb13-9" aria-hidden="true" tabindex="-1"></a>color.vector <span class="ot">&lt;-</span> color.vector[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(color.vector)]</span>
<span id="cb13-10"><a href="simWithout.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="simWithout.html#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(longData, <span class="fu">aes</span>(<span class="at">x =</span> Var2, <span class="at">y =</span> Var1)) <span class="sc">+</span> </span>
<span id="cb13-12"><a href="simWithout.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill=</span>value)) <span class="sc">+</span> </span>
<span id="cb13-13"><a href="simWithout.html#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(x,y), <span class="at">position=</span><span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.5</span>), </span>
<span id="cb13-14"><a href="simWithout.html#cb13-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb13-15"><a href="simWithout.html#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb13-16"><a href="simWithout.html#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_gradientn(colors=rev(terrain.colors(12))) </span></span>
<span id="cb13-17"><a href="simWithout.html#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span>color.vector)</span></code></pre></div>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="width:45%">
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="simWithout.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora, vamos a explorar el resultado de nuestros muestreos en cada una de las visitas:</span></span>
<span id="cb14-2"><a href="simWithout.html#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="simWithout.html#cb14-3" aria-hidden="true" tabindex="-1"></a>dataset</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="simWithout.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a readable table</span></span>
<span id="cb15-2"><a href="simWithout.html#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="simWithout.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb15-4"><a href="simWithout.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dataset)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">site_ID</th>
<th align="right">trueN</th>
<th align="right">O1</th>
<th align="right">O2</th>
<th align="right">O3</th>
<th align="right">O4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">19</td>
<td align="right">7</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">95</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">77</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">87</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">75</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">91</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">33</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">38</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">32</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">96</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">54</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">90</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>La primera columna (site_ID) es un identificador de la cuadrícula. La segunda (trueN) indica el número real de individuos que se encuentran en cada cuadrícula de nuestro muestreo. Las 4 columnas siguientes (O1,O2… O4) indican el número de ciervos detectados en cada una de nuestras visitas/ocasiones. Como habíamos predicho, al tener un 40% de detectabilidad, casi siempre detectamos menos de la mitad de ciervos de los que realmente hay.</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>The first column (site_ID) is an identifier for the grid. The second (trueN) indicates the real number of individuals found in each grid of our sampling. The next 4 columns (O1, O2… O4) indicate the number of deer detected in each of our visits / occasions. As we had predicted, with 40% detectability, we almost always detect less than half as many deer as there actually are.</p>
</div>
</div>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>En el mundo real, el problema surge al no conocer esa detectabilidad. Al realizar los distintos muestreos no sabemos realmente cuál es el procentaje de individios que somos capaces de detectar. Una primera estima sería quedarnos con el valor máximo de cada una de nuestras visitas para cada uno de los 15 muestreos. Asumiendo que la población en cada celda es cerrada (sin migración, nacimientos o muerte de individuos) el numero máximo de individuos detectados en cada una de las 4 visitas podría ser un buen punto de partida para aproximar una abundancia total. Lo calculamos y lo comparamos con el número real del siguiente modo:</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>In the real world, the problem arises from not knowing that detectability. When carrying out the different samplings, we do not really know what percentage of individuals we are capable of detecting. A first estimate would be to keep the maximum value of each of our visits for each of the 15 samplings. Assuming that the population in each cell is closed (without migration, births or death of individuals) the maximum number of individuals detected in each of the 4 visits could be a good starting point to approximate a total abundance. We calculate it and compare it with the real number as follows:</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="simWithout.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos los individuos máximos detectados por visita</span></span>
<span id="cb16-2"><a href="simWithout.html#cb16-2" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>maxN <span class="ot">&lt;-</span> <span class="fu">apply</span>(dataset[,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>],<span class="dv">1</span>, max)</span>
<span id="cb16-3"><a href="simWithout.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="simWithout.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficamos la relación con los individuos reales</span></span>
<span id="cb16-5"><a href="simWithout.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataset<span class="sc">$</span>trueN, dataset<span class="sc">$</span>maxN, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">7.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">7.5</span>), </span>
<span id="cb16-6"><a href="simWithout.html#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;número real de individuos&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;número detectado de individuos&quot;</span>)</span>
<span id="cb16-7"><a href="simWithout.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="simWithout.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preserve source dataset</span></span>
<span id="cb17-2"><a href="simWithout.html#cb17-2" aria-hidden="true" tabindex="-1"></a>datasetJavi <span class="ot">&lt;-</span> dataset</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="simWithout.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() version</span></span>
<span id="cb18-2"><a href="simWithout.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="simWithout.html#cb18-3" aria-hidden="true" tabindex="-1"></a>datsetTidy <span class="ot">&lt;-</span> datasetJavi <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="simWithout.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  rowwise <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="simWithout.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">maxN =</span> <span class="fu">max</span>(<span class="fu">c</span>(O1, O2, O3, O4)))</span>
<span id="cb18-6"><a href="simWithout.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="simWithout.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb18-8"><a href="simWithout.html#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data=</span>datsetTidy, <span class="fu">aes</span>(trueN, maxN), </span>
<span id="cb18-9"><a href="simWithout.html#cb18-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">stroke =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="simWithout.html#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> </span>
<span id="cb18-11"><a href="simWithout.html#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="simWithout.html#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="simWithout.html#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span></span>
<span id="cb18-14"><a href="simWithout.html#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">x =</span> <span class="st">&quot;poisson deer population&quot;</span>,</span>
<span id="cb18-15"><a href="simWithout.html#cb18-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">&quot;max deer observed&quot;</span>)</span></code></pre></div>
<div style="display: flex;">
<div class="col" style="width:45%">
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<p>note, for the ggplot() version on the right, the points are “jittered” to expose overlapping data. Default jittering can cause some points to be drawn above the abline() line (suggesting an impossible result, that is, a trial count maximum greater than the poisson cell population).
<br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>Como veníamos intuyendo, infraestimamos el número real de ciervos. De hecho, como sabemos que tenemos un 40% de eficacia de detección, podríamos adelantar que, de media, seguramente estaremos detectando aproximadamente un 40% de ciervos de los que hay en realidad. Vamos a comprobarlo:</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>As we had been intuiting, we underestimated the real number of deer. In fact, as we know that we have a 40% detection efficiency, we could anticipate that, on average, we will surely be detecting approximately 40% of the deer that there are in reality. Let’s check it out:</p>
</div>
</div>
<p><br /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="simWithout.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos la media de individuos vistos en las 4 visitas</span></span>
<span id="cb19-2"><a href="simWithout.html#cb19-2" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>meanN <span class="ot">&lt;-</span> <span class="fu">apply</span>(dataset[,<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>],<span class="dv">1</span>, mean)</span>
<span id="cb19-3"><a href="simWithout.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="simWithout.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Sumamos las medias de los 15 sitios y lo comparamos con los valores reales</span></span>
<span id="cb19-5"><a href="simWithout.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(dataset<span class="sc">$</span>meanN) <span class="sc">/</span> <span class="fu">sum</span>(dataset<span class="sc">$</span>trueN)</span></code></pre></div>
<pre><code>## [1] 0.3928571</code></pre>
<p><br /></p>
<div style="display: flex;">
<div class="col" style="font-style: italic; background-color: #d9d9d9; border-style:solid; width:45%">
<p>Efectivamente, de media estamos viendo un 39% de los individuos que realmente hay. Para poder ajustar un modelo que fuese capaz de calcular el número total de individuos, deberíamos primero ser capaces de calcular esa detectabilidad, esto es, el parámetro p de la distribución binomial.</p>
</div>
<div class="col">
<p> 
<!-- an empty Div (with a white space), serving as
a column separator --></p>
</div>
<div class="col" style="width:45%">
<p>Indeed, on average we are seeing 39% of the individuals that there really are. In order to fit a model that is capable of calculating the total number of individuals, we should first be able to calculate that detectability, that is, the parameter p of the binomial distribution.</p>
</div>
</div>
<p><br /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gen.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="unmarked.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-simulation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
